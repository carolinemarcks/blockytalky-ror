"use strict";Blockly.JavaScript=Blockly.Generator.get("JavaScript"),Blockly.JavaScript.addReservedWords("Blockly,break,case,catch,continue,debugger,default,delete,do,else,finally,for,function,if,in,instanceof,new,return,switch,this,throw,try,typeof,var,void,while,with,class,enum,export,extends,import,super,implements,interface,let,package,private,protected,public,static,yield,const,null,true,false,Array,ArrayBuffer,Boolean,Date,decodeURI,decodeURIComponent,encodeURI,encodeURIComponent,Error,eval,EvalError,Float32Array,Float64Array,Function,Infinity,Int16Array,Int32Array,Int8Array,isFinite,isNaN,Iterator,JSON,Math,NaN,Number,Object,parseFloat,parseInt,RangeError,ReferenceError,RegExp,StopIteration,String,SyntaxError,TypeError,Uint16Array,Uint32Array,Uint8Array,Uint8ClampedArray,undefined,uneval,URIError,applicationCache,closed,Components,content,_content,controllers,crypto,defaultStatus,dialogArguments,directories,document,frameElement,frames,fullScreen,globalStorage,history,innerHeight,innerWidth,length,location,locationbar,localStorage,menubar,messageManager,mozAnimationStartTime,mozInnerScreenX,mozInnerScreenY,mozPaintCount,name,navigator,opener,outerHeight,outerWidth,pageXOffset,pageYOffset,parent,performance,personalbar,pkcs11,returnValue,screen,screenX,screenY,scrollbars,scrollMaxX,scrollMaxY,scrollX,scrollY,self,sessionStorage,sidebar,status,statusbar,toolbar,top,URL,window,addEventListener,alert,atob,back,blur,btoa,captureEvents,clearImmediate,clearInterval,clearTimeout,close,confirm,disableExternalCapture,dispatchEvent,dump,enableExternalCapture,escape,find,focus,forward,GeckoActiveXObject,getAttention,getAttentionWithCycleCount,getComputedStyle,getSelection,home,matchMedia,maximize,minimize,moveBy,moveTo,mozRequestAnimationFrame,open,openDialog,postMessage,print,prompt,QueryInterface,releaseEvents,removeEventListener,resizeBy,resizeTo,restore,routeEvent,scroll,scrollBy,scrollByLines,scrollByPages,scrollTo,setCursor,setImmediate,setInterval,setResizable,setTimeout,showModalDialog,sizeToContent,stop,unescape,updateCommands,XPCNativeWrapper,XPCSafeJSObjectWrapper,onabort,onbeforeunload,onblur,onchange,onclick,onclose,oncontextmenu,ondevicemotion,ondeviceorientation,ondragdrop,onerror,onfocus,onhashchange,onkeydown,onkeypress,onkeyup,onload,onmousedown,onmousemove,onmouseout,onmouseover,onmouseup,onmozbeforepaint,onpaint,onpopstate,onreset,onresize,onscroll,onselect,onsubmit,onunload,onpageshow,onpagehide,Image,Option,Worker,Event,Range,File,FileReader,Blob,BlobBuilder,Attr,CDATASection,CharacterData,Comment,console,DocumentFragment,DocumentType,DomConfiguration,DOMError,DOMErrorHandler,DOMException,DOMImplementation,DOMImplementationList,DOMImplementationRegistry,DOMImplementationSource,DOMLocator,DOMObject,DOMString,DOMStringList,DOMTimeStamp,DOMUserData,Entity,EntityReference,MediaQueryList,MediaQueryListListener,NameList,NamedNodeMap,Node,NodeFilter,NodeIterator,NodeList,Notation,Plugin,PluginArray,ProcessingInstruction,SharedWorker,Text,TimeRanges,Treewalker,TypeInfo,UserDataHandler,Worker,WorkerGlobalScope,HTMLDocument,HTMLElement,HTMLAnchorElement,HTMLAppletElement,HTMLAudioElement,HTMLAreaElement,HTMLBaseElement,HTMLBaseFontElement,HTMLBodyElement,HTMLBRElement,HTMLButtonElement,HTMLCanvasElement,HTMLDirectoryElement,HTMLDivElement,HTMLDListElement,HTMLEmbedElement,HTMLFieldSetElement,HTMLFontElement,HTMLFormElement,HTMLFrameElement,HTMLFrameSetElement,HTMLHeadElement,HTMLHeadingElement,HTMLHtmlElement,HTMLHRElement,HTMLIFrameElement,HTMLImageElement,HTMLInputElement,HTMLKeygenElement,HTMLLabelElement,HTMLLIElement,HTMLLinkElement,HTMLMapElement,HTMLMenuElement,HTMLMetaElement,HTMLModElement,HTMLObjectElement,HTMLOListElement,HTMLOptGroupElement,HTMLOptionElement,HTMLOutputElement,HTMLParagraphElement,HTMLParamElement,HTMLPreElement,HTMLQuoteElement,HTMLScriptElement,HTMLSelectElement,HTMLSourceElement,HTMLSpanElement,HTMLStyleElement,HTMLTableElement,HTMLTableCaptionElement,HTMLTableCellElement,HTMLTableDataCellElement,HTMLTableHeaderCellElement,HTMLTableColElement,HTMLTableRowElement,HTMLTableSectionElement,HTMLTextAreaElement,HTMLTimeElement,HTMLTitleElement,HTMLTrackElement,HTMLUListElement,HTMLUnknownElement,HTMLVideoElement,HTMLCanvasElement,CanvasRenderingContext2D,CanvasGradient,CanvasPattern,TextMetrics,ImageData,CanvasPixelArray,HTMLAudioElement,HTMLVideoElement,NotifyAudioAvailableEvent,HTMLCollection,HTMLAllCollection,HTMLFormControlsCollection,HTMLOptionsCollection,HTMLPropertiesCollection,DOMTokenList,DOMSettableTokenList,DOMStringMap,RadioNodeList,SVGDocument,SVGElement,SVGAElement,SVGAltGlyphElement,SVGAltGlyphDefElement,SVGAltGlyphItemElement,SVGAnimationElement,SVGAnimateElement,SVGAnimateColorElement,SVGAnimateMotionElement,SVGAnimateTransformElement,SVGSetElement,SVGCircleElement,SVGClipPathElement,SVGColorProfileElement,SVGCursorElement,SVGDefsElement,SVGDescElement,SVGEllipseElement,SVGFilterElement,SVGFilterPrimitiveStandardAttributes,SVGFEBlendElement,SVGFEColorMatrixElement,SVGFEComponentTransferElement,SVGFECompositeElement,SVGFEConvolveMatrixElement,SVGFEDiffuseLightingElement,SVGFEDisplacementMapElement,SVGFEDistantLightElement,SVGFEFloodElement,SVGFEGaussianBlurElement,SVGFEImageElement,SVGFEMergeElement,SVGFEMergeNodeElement,SVGFEMorphologyElement,SVGFEOffsetElement,SVGFEPointLightElement,SVGFESpecularLightingElement,SVGFESpotLightElement,SVGFETileElement,SVGFETurbulenceElement,SVGComponentTransferFunctionElement,SVGFEFuncRElement,SVGFEFuncGElement,SVGFEFuncBElement,SVGFEFuncAElement,SVGFontElement,SVGFontFaceElement,SVGFontFaceFormatElement,SVGFontFaceNameElement,SVGFontFaceSrcElement,SVGFontFaceUriElement,SVGForeignObjectElement,SVGGElement,SVGGlyphElement,SVGGlyphRefElement,SVGGradientElement,SVGLinearGradientElement,SVGRadialGradientElement,SVGHKernElement,SVGImageElement,SVGLineElement,SVGMarkerElement,SVGMaskElement,SVGMetadataElement,SVGMissingGlyphElement,SVGMPathElement,SVGPathElement,SVGPatternElement,SVGPolylineElement,SVGPolygonElement,SVGRectElement,SVGScriptElement,SVGStopElement,SVGStyleElement,SVGSVGElement,SVGSwitchElement,SVGSymbolElement,SVGTextElement,SVGTextPathElement,SVGTitleElement,SVGTRefElement,SVGTSpanElement,SVGUseElement,SVGViewElement,SVGVKernElement,SVGAngle,SVGColor,SVGICCColor,SVGElementInstance,SVGElementInstanceList,SVGLength,SVGLengthList,SVGMatrix,SVGNumber,SVGNumberList,SVGPaint,SVGPoint,SVGPointList,SVGPreserveAspectRatio,SVGRect,SVGStringList,SVGTransform,SVGTransformList,SVGAnimatedAngle,SVGAnimatedBoolean,SVGAnimatedEnumeration,SVGAnimatedInteger,SVGAnimatedLength,SVGAnimatedLengthList,SVGAnimatedNumber,SVGAnimatedNumberList,SVGAnimatedPreserveAspectRatio,SVGAnimatedRect,SVGAnimatedString,SVGAnimatedTransformList,SVGPathSegList,SVGPathSeg,SVGPathSegArcAbs,SVGPathSegArcRel,SVGPathSegClosePath,SVGPathSegCurvetoCubicAbs,SVGPathSegCurvetoCubicRel,SVGPathSegCurvetoCubicSmoothAbs,SVGPathSegCurvetoCubicSmoothRel,SVGPathSegCurvetoQuadraticAbs,SVGPathSegCurvetoQuadraticRel,SVGPathSegCurvetoQuadraticSmoothAbs,SVGPathSegCurvetoQuadraticSmoothRel,SVGPathSegLinetoAbs,SVGPathSegLinetoHorizontalAbs,SVGPathSegLinetoHorizontalRel,SVGPathSegLinetoRel,SVGPathSegLinetoVerticalAbs,SVGPathSegLinetoVerticalRel,SVGPathSegMovetoAbs,SVGPathSegMovetoRel,ElementTimeControl,TimeEvent,SVGAnimatedPathData,SVGAnimatedPoints,SVGColorProfileRule,SVGCSSRule,SVGExternalResourcesRequired,SVGFitToViewBox,SVGLangSpace,SVGLocatable,SVGRenderingIntent,SVGStylable,SVGTests,SVGTextContentElement,SVGTextPositioningElement,SVGTransformable,SVGUnitTypes,SVGURIReference,SVGViewSpec,SVGZoomAndPan"),Blockly.JavaScript.ORDER_ATOMIC=0,Blockly.JavaScript.ORDER_MEMBER=1,Blockly.JavaScript.ORDER_NEW=1,Blockly.JavaScript.ORDER_FUNCTION_CALL=2,Blockly.JavaScript.ORDER_INCREMENT=3,Blockly.JavaScript.ORDER_DECREMENT=3,Blockly.JavaScript.ORDER_LOGICAL_NOT=4,Blockly.JavaScript.ORDER_BITWISE_NOT=4,Blockly.JavaScript.ORDER_UNARY_PLUS=4,Blockly.JavaScript.ORDER_UNARY_NEGATION=4,Blockly.JavaScript.ORDER_TYPEOF=4,Blockly.JavaScript.ORDER_VOID=4,Blockly.JavaScript.ORDER_DELETE=4,Blockly.JavaScript.ORDER_MULTIPLICATION=5,Blockly.JavaScript.ORDER_DIVISION=5,Blockly.JavaScript.ORDER_MODULUS=5,Blockly.JavaScript.ORDER_ADDITION=6,Blockly.JavaScript.ORDER_SUBTRACTION=6,Blockly.JavaScript.ORDER_BITWISE_SHIFT=7,Blockly.JavaScript.ORDER_RELATIONAL=8,Blockly.JavaScript.ORDER_IN=8,Blockly.JavaScript.ORDER_INSTANCEOF=8,Blockly.JavaScript.ORDER_EQUALITY=9,Blockly.JavaScript.ORDER_BITWISE_AND=10,Blockly.JavaScript.ORDER_BITWISE_XOR=11,Blockly.JavaScript.ORDER_BITWISE_OR=12,Blockly.JavaScript.ORDER_LOGICAL_AND=13,Blockly.JavaScript.ORDER_LOGICAL_OR=14,Blockly.JavaScript.ORDER_CONDITIONAL=15,Blockly.JavaScript.ORDER_ASSIGNMENT=16,Blockly.JavaScript.ORDER_COMMA=17,Blockly.JavaScript.ORDER_NONE=99,Blockly.JavaScript.INFINITE_LOOP_TRAP=null,Blockly.JavaScript.init=function(){if(Blockly.JavaScript.definitions_={},Blockly.Variables){Blockly.JavaScript.variableDB_?Blockly.JavaScript.variableDB_.reset():Blockly.JavaScript.variableDB_=new Blockly.Names(Blockly.JavaScript.RESERVED_WORDS_);for(var t=[],a=Blockly.Variables.allVariables(),e=0;e<a.length;e++)t[e]="var "+Blockly.JavaScript.variableDB_.getName(a[e],Blockly.Variables.NAME_TYPE)+";";Blockly.JavaScript.definitions_.variables=t.join("\n")}},Blockly.JavaScript.finish=function(t){var a,e=[];for(a in Blockly.JavaScript.definitions_)e.push(Blockly.JavaScript.definitions_[a]);return e.join("\n\n")+"\n\n\n"+t},Blockly.JavaScript.scrubNakedValue=function(t){return t+";\n"},Blockly.JavaScript.quote_=function(t){return t=t.replace(/\\/g,"\\\\").replace(/\n/g,"\\\n").replace(/'/g,"\\'"),"'"+t+"'"},Blockly.JavaScript.scrub_=function(t,a){if(null===a)return"";var e="";if(!t.outputConnection||!t.outputConnection.targetConnection){var l=t.getCommentText();l&&(e+=Blockly.Generator.prefixLines(l,"// ")+"\n");for(var i=0;i<t.inputList.length;i++)t.inputList[i].type==Blockly.INPUT_VALUE&&(l=t.inputList[i].connection.targetBlock())&&(l=Blockly.Generator.allNestedComments(l))&&(e+=Blockly.Generator.prefixLines(l,"// "))}return i=t.nextConnection&&t.nextConnection.targetBlock(),i=this.blockToCode(i),e+a+i},Blockly.JavaScript.logic={},Blockly.JavaScript.controls_if=function(){for(var t=0,a=Blockly.JavaScript.valueToCode(this,"IF"+t,Blockly.JavaScript.ORDER_NONE)||"false",e=Blockly.JavaScript.statementToCode(this,"DO"+t),l="if ("+a+") {\n"+e+"}",t=1;t<=this.elseifCount_;t++)a=Blockly.JavaScript.valueToCode(this,"IF"+t,Blockly.JavaScript.ORDER_NONE)||"false",e=Blockly.JavaScript.statementToCode(this,"DO"+t),l+=" else if ("+a+") {\n"+e+"}\n";return this.elseCount_&&(e=Blockly.JavaScript.statementToCode(this,"ELSE"),l+=" else {\n"+e+"}\n"),l+"\n"},Blockly.JavaScript.logic_compare=function(){var t=this.getTitleValue("OP"),t=Blockly.JavaScript.logic_compare.OPERATORS[t],a="=="==t||"!="==t?Blockly.JavaScript.ORDER_EQUALITY:Blockly.JavaScript.ORDER_RELATIONAL,e=Blockly.JavaScript.valueToCode(this,"A",a)||"0",l=Blockly.JavaScript.valueToCode(this,"B",a)||"0";return[e+" "+t+" "+l,a]},Blockly.JavaScript.logic_compare.OPERATORS={EQ:"==",NEQ:"!=",LT:"<",LTE:"<=",GT:">",GTE:">="},Blockly.JavaScript.logic_operation=function(){var t="AND"==this.getTitleValue("OP")?"&&":"||",a="&&"==t?Blockly.JavaScript.ORDER_LOGICAL_AND:Blockly.JavaScript.ORDER_LOGICAL_OR,e=Blockly.JavaScript.valueToCode(this,"A",a)||"false",l=Blockly.JavaScript.valueToCode(this,"B",a)||"false";return[e+" "+t+" "+l,a]},Blockly.JavaScript.logic_negate=function(){var t=Blockly.JavaScript.ORDER_LOGICAL_NOT;return["!"+(Blockly.JavaScript.valueToCode(this,"BOOL",t)||"false"),t]},Blockly.JavaScript.logic_boolean=function(){return["TRUE"==this.getTitleValue("BOOL")?"true":"false",Blockly.JavaScript.ORDER_ATOMIC]},Blockly.JavaScript.logic_null=function(){return["null",Blockly.JavaScript.ORDER_ATOMIC]},Blockly.JavaScript.logic_ternary=function(){var t=Blockly.JavaScript.valueToCode(this,"IF",Blockly.JavaScript.ORDER_CONDITIONAL)||"false",a=Blockly.JavaScript.valueToCode(this,"THEN",Blockly.JavaScript.ORDER_CONDITIONAL)||"null",e=Blockly.JavaScript.valueToCode(this,"ELSE",Blockly.JavaScript.ORDER_CONDITIONAL)||"null";return[t+" ? "+a+" : "+e,Blockly.JavaScript.ORDER_CONDITIONAL]},Blockly.JavaScript.colour={},Blockly.JavaScript.colour_picker=function(){return["'"+this.getTitleValue("COLOUR")+"'",Blockly.JavaScript.ORDER_ATOMIC]},Blockly.JavaScript.colour_random=function(){if(!Blockly.JavaScript.definitions_.colour_random){var t=Blockly.JavaScript.variableDB_.getDistinctName("colour_random",Blockly.Generator.NAME_TYPE);Blockly.JavaScript.colour_random.functionName=t;var a=[];a.push("function "+t+"() {"),a.push("  var num = Math.floor(Math.random() * Math.pow(2, 24));"),a.push("  return '#' + ('00000' + num.toString(16)).substr(-6);"),a.push("}"),Blockly.JavaScript.definitions_.colour_random=a.join("\n")}return[Blockly.JavaScript.colour_random.functionName+"()",Blockly.JavaScript.ORDER_FUNCTION_CALL]},Blockly.JavaScript.colour_rgb=function(){var t=Blockly.JavaScript.valueToCode(this,"RED",Blockly.JavaScript.ORDER_COMMA)||0,a=Blockly.JavaScript.valueToCode(this,"GREEN",Blockly.JavaScript.ORDER_COMMA)||0,e=Blockly.JavaScript.valueToCode(this,"BLUE",Blockly.JavaScript.ORDER_COMMA)||0;if(!Blockly.JavaScript.definitions_.colour_rgb){var l=Blockly.JavaScript.variableDB_.getDistinctName("colour_rgb",Blockly.Generator.NAME_TYPE);Blockly.JavaScript.colour_rgb.functionName=l;var i=[];i.push("function "+l+"(r, g, b) {"),i.push("  r = Math.round(Math.max(Math.min(Number(r), 100), 0) * 2.55);"),i.push("  g = Math.round(Math.max(Math.min(Number(g), 100), 0) * 2.55);"),i.push("  b = Math.round(Math.max(Math.min(Number(b), 100), 0) * 2.55);"),i.push("  r = ('0' + (r || 0).toString(16)).slice(-2);"),i.push("  g = ('0' + (g || 0).toString(16)).slice(-2);"),i.push("  b = ('0' + (b || 0).toString(16)).slice(-2);"),i.push("  return '#' + r + g + b;"),i.push("}"),Blockly.JavaScript.definitions_.colour_rgb=i.join("\n")}return[Blockly.JavaScript.colour_rgb.functionName+"("+t+", "+a+", "+e+")",Blockly.JavaScript.ORDER_FUNCTION_CALL]},Blockly.JavaScript.colour_blend=function(){var t=Blockly.JavaScript.valueToCode(this,"COLOUR1",Blockly.JavaScript.ORDER_COMMA)||"'#000000'",a=Blockly.JavaScript.valueToCode(this,"COLOUR2",Blockly.JavaScript.ORDER_COMMA)||"'#000000'",e=Blockly.JavaScript.valueToCode(this,"RATIO",Blockly.JavaScript.ORDER_COMMA)||.5;if(!Blockly.JavaScript.definitions_.colour_blend){var l=Blockly.JavaScript.variableDB_.getDistinctName("colour_blend",Blockly.Generator.NAME_TYPE);Blockly.JavaScript.colour_blend.functionName=l;var i=[];i.push("function "+l+"(c1, c2, ratio) {"),i.push("  ratio = Math.max(Math.min(Number(ratio), 1), 0);"),i.push("  var r1 = parseInt(c1.substring(1, 3), 16);"),i.push("  var g1 = parseInt(c1.substring(3, 5), 16);"),i.push("  var b1 = parseInt(c1.substring(5, 7), 16);"),i.push("  var r2 = parseInt(c2.substring(1, 3), 16);"),i.push("  var g2 = parseInt(c2.substring(3, 5), 16);"),i.push("  var b2 = parseInt(c2.substring(5, 7), 16);"),i.push("  var r = Math.round(r1 * (1 - ratio) + r2 * ratio);"),i.push("  var g = Math.round(g1 * (1 - ratio) + g2 * ratio);"),i.push("  var b = Math.round(b1 * (1 - ratio) + b2 * ratio);"),i.push("  r = ('0' + (r || 0).toString(16)).slice(-2);"),i.push("  g = ('0' + (g || 0).toString(16)).slice(-2);"),i.push("  b = ('0' + (b || 0).toString(16)).slice(-2);"),i.push("  return '#' + r + g + b;"),i.push("}"),Blockly.JavaScript.definitions_.colour_blend=i.join("\n")}return[Blockly.JavaScript.colour_blend.functionName+"("+t+", "+a+", "+e+")",Blockly.JavaScript.ORDER_FUNCTION_CALL]},Blockly.JavaScript.control={},Blockly.JavaScript.controls_repeat=function(){var t=Number(this.getTitleValue("TIMES")),a=Blockly.JavaScript.statementToCode(this,"DO");Blockly.JavaScript.INFINITE_LOOP_TRAP&&(a=Blockly.JavaScript.INFINITE_LOOP_TRAP.replace(/%1/g,"'"+this.id+"'")+a);var e=Blockly.JavaScript.variableDB_.getDistinctName("count",Blockly.Variables.NAME_TYPE);return"for (var "+e+" = 0; "+e+" < "+t+"; "+e+"++) {\n"+a+"}\n"},Blockly.JavaScript.controls_repeat_ext=function(){var t=Blockly.JavaScript.valueToCode(this,"TIMES",Blockly.JavaScript.ORDER_ASSIGNMENT)||"0",a=Blockly.JavaScript.statementToCode(this,"DO");Blockly.JavaScript.INFINITE_LOOP_TRAP&&(a=Blockly.JavaScript.INFINITE_LOOP_TRAP.replace(/%1/g,"'"+this.id+"'")+a);var e="",l=Blockly.JavaScript.variableDB_.getDistinctName("count",Blockly.Variables.NAME_TYPE),i=t;return t.match(/^\w+$/)||Blockly.isNumber(t)||(i=Blockly.JavaScript.variableDB_.getDistinctName("repeat_end",Blockly.Variables.NAME_TYPE),e+="var "+i+" = "+t+";\n"),e+("for (var "+l+" = 0; "+l+" < "+i+"; "+l+"++) {\n"+a+"}\n")},Blockly.JavaScript.controls_whileUntil=function(){var t="UNTIL"==this.getTitleValue("MODE"),a=Blockly.JavaScript.valueToCode(this,"BOOL",t?Blockly.JavaScript.ORDER_LOGICAL_NOT:Blockly.JavaScript.ORDER_NONE)||"false",e=Blockly.JavaScript.statementToCode(this,"DO");return Blockly.JavaScript.INFINITE_LOOP_TRAP&&(e=Blockly.JavaScript.INFINITE_LOOP_TRAP.replace(/%1/g,"'"+this.id+"'")+e),t&&(a="!"+a),"while ("+a+") {\n"+e+"}\n"},Blockly.JavaScript.controls_for=function(){var t=Blockly.JavaScript.variableDB_.getName(this.getTitleValue("VAR"),Blockly.Variables.NAME_TYPE),a=Blockly.JavaScript.valueToCode(this,"FROM",Blockly.JavaScript.ORDER_ASSIGNMENT)||"0",e=Blockly.JavaScript.valueToCode(this,"TO",Blockly.JavaScript.ORDER_ASSIGNMENT)||"0",l=Blockly.JavaScript.valueToCode(this,"BY",Blockly.JavaScript.ORDER_ASSIGNMENT)||"1",i=Blockly.JavaScript.statementToCode(this,"DO");Blockly.JavaScript.INFINITE_LOOP_TRAP&&(i=Blockly.JavaScript.INFINITE_LOOP_TRAP.replace(/%1/g,"'"+this.id+"'")+i);var r;if(Blockly.isNumber(a)&&Blockly.isNumber(e)&&Blockly.isNumber(l)){var o=parseFloat(a)<=parseFloat(e);r="for ("+t+" = "+a+"; "+t+(o?" <= ":" >= ")+e+"; "+t,t=Math.abs(parseFloat(l)),r=(1==t?r+(o?"++":"--"):r+((o?" += ":" -= ")+t))+(") {\n"+i+"}\n")}else r="",o=a,a.match(/^\w+$/)||Blockly.isNumber(a)||(o=Blockly.JavaScript.variableDB_.getDistinctName(t+"_start",Blockly.Variables.NAME_TYPE),r+="var "+o+" = "+a+";\n"),a=e,e.match(/^\w+$/)||Blockly.isNumber(e)||(a=Blockly.JavaScript.variableDB_.getDistinctName(t+"_end",Blockly.Variables.NAME_TYPE),r+="var "+a+" = "+e+";\n"),e=Blockly.JavaScript.variableDB_.getDistinctName(t+"_inc",Blockly.Variables.NAME_TYPE),r+="var "+e+" = ",r=Blockly.isNumber(l)?r+(Math.abs(l)+";\n"):r+("Math.abs("+l+");\n"),r+="if ("+o+" > "+a+") {\n",r+="  "+e+" = -"+e+";\n",r+="}\n",r+="for ("+t+" = "+o+";\n     "+e+" >= 0 ? "+t+" <= "+a+" : "+t+" >= "+a+";\n     "+t+" += "+e+") {\n"+i+"}\n";return r},Blockly.JavaScript.controls_forEach=function(){var t=Blockly.JavaScript.variableDB_.getName(this.getTitleValue("VAR"),Blockly.Variables.NAME_TYPE),a=Blockly.JavaScript.valueToCode(this,"LIST",Blockly.JavaScript.ORDER_ASSIGNMENT)||"[]",e=Blockly.JavaScript.statementToCode(this,"DO");Blockly.JavaScript.INFINITE_LOOP_TRAP&&(e=Blockly.JavaScript.INFINITE_LOOP_TRAP.replace(/%1/g,"'"+this.id+"'")+e);var l=Blockly.JavaScript.variableDB_.getDistinctName(t+"_index",Blockly.Variables.NAME_TYPE);if(a.match(/^\w+$/))t="for (var "+l+" in  "+a+") {\n"+("  "+t+" = "+a+"["+l+"];\n"+e)+"}\n";else var i=Blockly.JavaScript.variableDB_.getDistinctName(t+"_list",Blockly.Variables.NAME_TYPE),e="  "+t+" = "+i+"["+l+"];\n"+e,t="var "+i+" = "+a+";\nfor (var "+l+" in "+i+") {\n"+e+"}\n";return t},Blockly.JavaScript.controls_flow_statements=function(){switch(this.getTitleValue("FLOW")){case"BREAK":return"break;\n";case"CONTINUE":return"continue;\n"}throw"Unknown flow statement."},Blockly.JavaScript.procedures={},Blockly.JavaScript.procedures_defreturn=function(){var t=Blockly.JavaScript.variableDB_.getName(this.getTitleValue("NAME"),Blockly.Procedures.NAME_TYPE),a=Blockly.JavaScript.statementToCode(this,"STACK");Blockly.JavaScript.INFINITE_LOOP_TRAP&&(a=Blockly.JavaScript.INFINITE_LOOP_TRAP.replace(/%1/g,"'"+this.id+"'")+a);var e=Blockly.JavaScript.valueToCode(this,"RETURN",Blockly.JavaScript.ORDER_NONE)||"";e&&(e="  return "+e+";\n");for(var l=[],i=0;i<this.arguments_.length;i++)l[i]=Blockly.JavaScript.variableDB_.getName(this.arguments_[i],Blockly.Variables.NAME_TYPE);return a="function "+t+"("+l.join(", ")+") {\n"+a+e+"}",a=Blockly.JavaScript.scrub_(this,a),Blockly.JavaScript.definitions_[t]=a,null},Blockly.JavaScript.procedures_defnoreturn=Blockly.JavaScript.procedures_defreturn,Blockly.JavaScript.procedures_callreturn=function(){for(var t=Blockly.JavaScript.variableDB_.getName(this.getTitleValue("NAME"),Blockly.Procedures.NAME_TYPE),a=[],e=0;e<this.arguments_.length;e++)a[e]=Blockly.JavaScript.valueToCode(this,"ARG"+e,Blockly.JavaScript.ORDER_COMMA)||"null";return[t+"("+a.join(", ")+")",Blockly.JavaScript.ORDER_FUNCTION_CALL]},Blockly.JavaScript.procedures_callnoreturn=function(){for(var t=Blockly.JavaScript.variableDB_.getName(this.getTitleValue("NAME"),Blockly.Procedures.NAME_TYPE),a=[],e=0;e<this.arguments_.length;e++)a[e]=Blockly.JavaScript.valueToCode(this,"ARG"+e,Blockly.JavaScript.ORDER_COMMA)||"null";return t+"("+a.join(", ")+");\n"},Blockly.JavaScript.procedures_ifreturn=function(){var t="if ("+(Blockly.JavaScript.valueToCode(this,"CONDITION",Blockly.JavaScript.ORDER_NONE)||"false")+") {\n";if(this.hasReturnValue_)var a=Blockly.JavaScript.valueToCode(this,"VALUE",Blockly.JavaScript.ORDER_NONE)||"null",t=t+("  return "+a+";\n");else t+="  return;\n";return t+"}\n"},Blockly.JavaScript.text={},Blockly.JavaScript.text=function(){return[Blockly.JavaScript.quote_(this.getTitleValue("TEXT")),Blockly.JavaScript.ORDER_ATOMIC]},Blockly.JavaScript.text_join=function(){var t;if(0==this.itemCount_)return["''",Blockly.JavaScript.ORDER_ATOMIC];if(1==this.itemCount_)return t=Blockly.JavaScript.valueToCode(this,"ADD0",Blockly.JavaScript.ORDER_NONE)||"''",["String("+t+")",Blockly.JavaScript.ORDER_FUNCTION_CALL];if(2==this.itemCount_){t=Blockly.JavaScript.valueToCode(this,"ADD0",Blockly.JavaScript.ORDER_NONE)||"''";var a=Blockly.JavaScript.valueToCode(this,"ADD1",Blockly.JavaScript.ORDER_NONE)||"''";return["String("+t+") + String("+a+")",Blockly.JavaScript.ORDER_ADDITION]}for(t=Array(this.itemCount_),a=0;a<this.itemCount_;a++)t[a]=Blockly.JavaScript.valueToCode(this,"ADD"+a,Blockly.JavaScript.ORDER_COMMA)||"''";return t="["+t.join(",")+"].join('')",[t,Blockly.JavaScript.ORDER_FUNCTION_CALL]},Blockly.JavaScript.text_append=function(){var t=Blockly.JavaScript.variableDB_.getName(this.getTitleValue("VAR"),Blockly.Variables.NAME_TYPE),a=Blockly.JavaScript.valueToCode(this,"TEXT",Blockly.JavaScript.ORDER_NONE)||"''";return t+" = String("+t+") + String("+a+");\n"},Blockly.JavaScript.text_length=function(){return[(Blockly.JavaScript.valueToCode(this,"VALUE",Blockly.JavaScript.ORDER_FUNCTION_CALL)||"''")+".length",Blockly.JavaScript.ORDER_MEMBER]},Blockly.JavaScript.text_isEmpty=function(){return["!"+(Blockly.JavaScript.valueToCode(this,"VALUE",Blockly.JavaScript.ORDER_MEMBER)||"''"),Blockly.JavaScript.ORDER_LOGICAL_NOT]},Blockly.JavaScript.text_indexOf=function(){var t="FIRST"==this.getTitleValue("END")?"indexOf":"lastIndexOf",a=Blockly.JavaScript.valueToCode(this,"FIND",Blockly.JavaScript.ORDER_NONE)||"''";return[(Blockly.JavaScript.valueToCode(this,"VALUE",Blockly.JavaScript.ORDER_MEMBER)||"''")+"."+t+"("+a+") + 1",Blockly.JavaScript.ORDER_MEMBER]},Blockly.JavaScript.text_charAt=function(){var t=this.getTitleValue("WHERE")||"FROM_START",a=Blockly.JavaScript.valueToCode(this,"AT",Blockly.JavaScript.ORDER_UNARY_NEGATION)||"1",e=Blockly.JavaScript.valueToCode(this,"VALUE",Blockly.JavaScript.ORDER_MEMBER)||"''";switch(t){case"FIRST":return[e+".charAt(0)",Blockly.JavaScript.ORDER_FUNCTION_CALL];case"LAST":return[e+".slice(-1)",Blockly.JavaScript.ORDER_FUNCTION_CALL];case"FROM_START":return a=Blockly.isNumber(a)?parseFloat(a)-1:a+" - 1",[e+".charAt("+a+")",Blockly.JavaScript.ORDER_FUNCTION_CALL];case"FROM_END":return[e+".slice(-"+a+").charAt(0)",Blockly.JavaScript.ORDER_FUNCTION_CALL];case"RANDOM":return Blockly.JavaScript.definitions_.text_random_letter||(t=Blockly.JavaScript.variableDB_.getDistinctName("text_random_letter",Blockly.Generator.NAME_TYPE),Blockly.JavaScript.text_charAt.text_random_letter=t,a=[],a.push("function "+t+"(text) {"),a.push("  var x = Math.floor(Math.random() * text.length);"),a.push("  return text[x];"),a.push("}"),Blockly.JavaScript.definitions_.text_random_letter=a.join("\n")),e=Blockly.JavaScript.text_charAt.text_random_letter+"("+e+")",[e,Blockly.JavaScript.ORDER_FUNCTION_CALL]}throw"Unhandled option (text_charAt)."},Blockly.JavaScript.text_getSubstring=function(){var t=Blockly.JavaScript.valueToCode(this,"STRING",Blockly.JavaScript.ORDER_MEMBER)||"[]",a=this.getTitleValue("WHERE1"),e=this.getTitleValue("WHERE2"),l=Blockly.JavaScript.valueToCode(this,"AT1",Blockly.JavaScript.ORDER_NONE)||"1",i=Blockly.JavaScript.valueToCode(this,"AT2",Blockly.JavaScript.ORDER_NONE)||"1";if("FIRST"!=a||"LAST"!=e){if(!Blockly.JavaScript.definitions_.text_get_substring){var r=Blockly.JavaScript.variableDB_.getDistinctName("text_get_substring",Blockly.Generator.NAME_TYPE);Blockly.JavaScript.text_getSubstring.func=r;var o=[];o.push("function "+r+"(text, where1, at1, where2, at2) {"),o.push("  function getAt(where, at) {"),o.push("    if (where == 'FROM_START') {"),o.push("      at--;"),o.push("    } else if (where == 'FROM_END') {"),o.push("      at = text.length - at;"),o.push("    } else if (where == 'FIRST') {"),o.push("      at = 0;"),o.push("    } else if (where == 'LAST') {"),o.push("      at = text.length - 1;"),o.push("    } else {"),o.push("      throw 'Unhandled option (text_getSubstring).';"),o.push("    }"),o.push("    return at;"),o.push("  }"),o.push("  at1 = getAt(where1, at1);"),o.push("  at2 = getAt(where2, at2) + 1;"),o.push("  return text.slice(at1, at2);"),o.push("}"),Blockly.JavaScript.definitions_.text_get_substring=o.join("\n")}t=Blockly.JavaScript.text_getSubstring.func+"("+t+", '"+a+"', "+l+", '"+e+"', "+i+")"}return[t,Blockly.JavaScript.ORDER_FUNCTION_CALL]},Blockly.JavaScript.text_changeCase=function(){var t=this.getTitleValue("CASE");if(t=Blockly.JavaScript.text_changeCase.OPERATORS[t])var a=Blockly.JavaScript.valueToCode(this,"TEXT",Blockly.JavaScript.ORDER_MEMBER)||"''",t=a+t;else Blockly.JavaScript.definitions_.text_toTitleCase||(t=Blockly.JavaScript.variableDB_.getDistinctName("text_toTitleCase",Blockly.Generator.NAME_TYPE),Blockly.JavaScript.text_changeCase.toTitleCase=t,a=[],a.push("function "+t+"(str) {"),a.push("  return str.replace(/\\S+/g,"),a.push("      function(txt) {return txt[0].toUpperCase() + txt.substring(1).toLowerCase();});"),a.push("}"),Blockly.JavaScript.definitions_.text_toTitleCase=a.join("\n")),a=Blockly.JavaScript.valueToCode(this,"TEXT",Blockly.JavaScript.ORDER_NONE)||"''",t=Blockly.JavaScript.text_changeCase.toTitleCase+"("+a+")";return[t,Blockly.JavaScript.ORDER_FUNCTION_CALL]},Blockly.JavaScript.text_changeCase.OPERATORS={UPPERCASE:".toUpperCase()",LOWERCASE:".toLowerCase()",TITLECASE:null},Blockly.JavaScript.text_trim=function(){var t=this.getTitleValue("MODE"),t=Blockly.JavaScript.text_trim.OPERATORS[t];return[(Blockly.JavaScript.valueToCode(this,"TEXT",Blockly.JavaScript.ORDER_MEMBER)||"''")+t,Blockly.JavaScript.ORDER_FUNCTION_CALL]},Blockly.JavaScript.text_trim.OPERATORS={LEFT:".trimLeft()",RIGHT:".trimRight()",BOTH:".trim()"},Blockly.JavaScript.text_print=function(){return"window.alert("+(Blockly.JavaScript.valueToCode(this,"TEXT",Blockly.JavaScript.ORDER_NONE)||"''")+");\n"},Blockly.JavaScript.text_prompt=function(){var t="window.prompt("+Blockly.JavaScript.quote_(this.getTitleValue("TEXT"))+")";return"NUMBER"==this.getTitleValue("TYPE")&&(t="window.parseFloat("+t+")"),[t,Blockly.JavaScript.ORDER_FUNCTION_CALL]},Blockly.JavaScript.math={},Blockly.JavaScript.math_number=function(){return[window.parseFloat(this.getTitleValue("NUM")),Blockly.JavaScript.ORDER_ATOMIC]},Blockly.JavaScript.math_arithmetic=function(){var t=this.getTitleValue("OP"),a=Blockly.JavaScript.math_arithmetic.OPERATORS[t],t=a[0],a=a[1],e=Blockly.JavaScript.valueToCode(this,"A",a)||"0",l=Blockly.JavaScript.valueToCode(this,"B",a)||"0";return t?[e+t+l,a]:["Math.pow("+e+", "+l+")",Blockly.JavaScript.ORDER_FUNCTION_CALL]},Blockly.JavaScript.math_arithmetic.OPERATORS={ADD:[" + ",Blockly.JavaScript.ORDER_ADDITION],MINUS:[" - ",Blockly.JavaScript.ORDER_SUBTRACTION],MULTIPLY:[" * ",Blockly.JavaScript.ORDER_MULTIPLICATION],DIVIDE:[" / ",Blockly.JavaScript.ORDER_DIVISION],POWER:[null,Blockly.JavaScript.ORDER_COMMA]},Blockly.JavaScript.math_single=function(){var t,a,e=this.getTitleValue("OP");if("NEG"==e)return a=Blockly.JavaScript.valueToCode(this,"NUM",Blockly.JavaScript.ORDER_UNARY_NEGATION)||"0","-"==a[0]&&(a=" "+a),["-"+a,Blockly.JavaScript.ORDER_UNARY_NEGATION];switch(a="SIN"==e||"COS"==e||"TAN"==e?Blockly.JavaScript.valueToCode(this,"NUM",Blockly.JavaScript.ORDER_DIVISION)||"0":Blockly.JavaScript.valueToCode(this,"NUM",Blockly.JavaScript.ORDER_NONE)||"0",e){case"ABS":t="Math.abs("+a+")";break;case"ROOT":t="Math.sqrt("+a+")";break;case"LN":t="Math.log("+a+")";break;case"EXP":t="Math.exp("+a+")";break;case"POW10":t="Math.pow(10,"+a+")";break;case"ROUND":t="Math.round("+a+")";break;case"ROUNDUP":t="Math.ceil("+a+")";break;case"ROUNDDOWN":t="Math.floor("+a+")";break;case"SIN":t="Math.sin("+a+" / 180 * Math.PI)";break;case"COS":t="Math.cos("+a+" / 180 * Math.PI)";break;case"TAN":t="Math.tan("+a+" / 180 * Math.PI)"}if(t)return[t,Blockly.JavaScript.ORDER_FUNCTION_CALL];switch(e){case"LOG10":t="Math.log("+a+") / Math.log(10)";break;case"ASIN":t="Math.asin("+a+") / Math.PI * 180";break;case"ACOS":t="Math.acos("+a+") / Math.PI * 180";break;case"ATAN":t="Math.atan("+a+") / Math.PI * 180";break;default:throw"Unknown math operator: "+e}return[t,Blockly.JavaScript.ORDER_DIVISION]},Blockly.JavaScript.math_constant=function(){var t=this.getTitleValue("CONSTANT");return Blockly.JavaScript.math_constant.CONSTANTS[t]},Blockly.JavaScript.math_constant.CONSTANTS={PI:["Math.PI",Blockly.JavaScript.ORDER_MEMBER],E:["Math.E",Blockly.JavaScript.ORDER_MEMBER],GOLDEN_RATIO:["(1 + Math.sqrt(5)) / 2",Blockly.JavaScript.ORDER_DIVISION],SQRT2:["Math.SQRT2",Blockly.JavaScript.ORDER_MEMBER],SQRT1_2:["Math.SQRT1_2",Blockly.JavaScript.ORDER_MEMBER],INFINITY:["Infinity",Blockly.JavaScript.ORDER_ATOMIC]},Blockly.JavaScript.math_number_property=function(){var t,a=Blockly.JavaScript.valueToCode(this,"NUMBER_TO_CHECK",Blockly.JavaScript.ORDER_MODULUS)||"NaN",e=this.getTitleValue("PROPERTY");if("PRIME"==e)return Blockly.JavaScript.definitions_.isPrime||(e=Blockly.JavaScript.variableDB_.getDistinctName("isPrime",Blockly.Generator.NAME_TYPE),Blockly.JavaScript.logic_prime=e,t=[],t.push("function "+e+"(n) {"),t.push("  // http://en.wikipedia.org/wiki/Primality_test#Naive_methods"),t.push("  if (n == 2 || n == 3) {"),t.push("    return true;"),t.push("  }"),t.push("  // False if n is NaN, negative, is 1, or not whole."),t.push("  // And false if n is divisible by 2 or 3."),t.push("  if (isNaN(n) || n <= 1 || n % 1 != 0 || n % 2 == 0 || n % 3 == 0) {"),t.push("    return false;"),t.push("  }"),t.push("  // Check all the numbers of form 6k +/- 1, up to sqrt(n)."),t.push("  for (var x = 6; x <= Math.sqrt(n) + 1; x += 6) {"),t.push("    if (n % (x - 1) == 0 || n % (x + 1) == 0) {"),t.push("      return false;"),t.push("    }"),t.push("  }"),t.push("  return true;"),t.push("}"),Blockly.JavaScript.definitions_.isPrime=t.join("\n")),t=Blockly.JavaScript.logic_prime+"("+a+")",[t,Blockly.JavaScript.ORDER_FUNCTION_CALL];switch(e){case"EVEN":t=a+" % 2 == 0";break;case"ODD":t=a+" % 2 == 1";break;case"WHOLE":t=a+" % 1 == 0";break;case"POSITIVE":t=a+" > 0";break;case"NEGATIVE":t=a+" < 0";break;case"DIVISIBLE_BY":e=Blockly.JavaScript.valueToCode(this,"DIVISOR",Blockly.JavaScript.ORDER_MODULUS)||"NaN",t=a+" % "+e+" == 0"}return[t,Blockly.JavaScript.ORDER_EQUALITY]},Blockly.JavaScript.math_change=function(){var t=Blockly.JavaScript.valueToCode(this,"DELTA",Blockly.JavaScript.ORDER_ADDITION)||"0",a=Blockly.JavaScript.variableDB_.getName(this.getTitleValue("VAR"),Blockly.Variables.NAME_TYPE);return a+" = (typeof "+a+" == 'number' ? "+a+" : 0) + "+t+";\n"},Blockly.JavaScript.math_round=Blockly.JavaScript.math_single,Blockly.JavaScript.math_trig=Blockly.JavaScript.math_single,Blockly.JavaScript.math_on_list=function(){var t=this.getTitleValue("OP");switch(t){case"SUM":t=Blockly.JavaScript.valueToCode(this,"LIST",Blockly.JavaScript.ORDER_MEMBER)||"[]",t+=".reduce(function(x, y) {return x + y;})";break;case"MIN":t=Blockly.JavaScript.valueToCode(this,"LIST",Blockly.JavaScript.ORDER_COMMA)||"[]",t="Math.min.apply(null, "+t+")";break;case"MAX":t=Blockly.JavaScript.valueToCode(this,"LIST",Blockly.JavaScript.ORDER_COMMA)||"[]",t="Math.max.apply(null, "+t+")";break;case"AVERAGE":if(!Blockly.JavaScript.definitions_.math_mean){var a=Blockly.JavaScript.variableDB_.getDistinctName("math_mean",Blockly.Generator.NAME_TYPE);
Blockly.JavaScript.math_on_list.math_mean=a,t=[],t.push("function "+a+"(myList) {"),t.push("  return myList.reduce(function(x, y) {return x + y;}) / myList.length;"),t.push("}"),Blockly.JavaScript.definitions_.math_mean=t.join("\n")}t=Blockly.JavaScript.valueToCode(this,"LIST",Blockly.JavaScript.ORDER_NONE)||"[]",t=Blockly.JavaScript.math_on_list.math_mean+"("+t+")";break;case"MEDIAN":Blockly.JavaScript.definitions_.math_median||(a=Blockly.JavaScript.variableDB_.getDistinctName("math_median",Blockly.Generator.NAME_TYPE),Blockly.JavaScript.math_on_list.math_median=a,t=[],t.push("function "+a+"(myList) {"),t.push("  var localList = myList.filter(function (x) {return typeof x == 'number';});"),t.push("  if (!localList.length) return null;"),t.push("  localList.sort(function(a, b) {return b - a;});"),t.push("  if (localList.length % 2 == 0) {"),t.push("    return (localList[localList.length / 2 - 1] + localList[localList.length / 2]) / 2;"),t.push("  } else {"),t.push("    return localList[(localList.length - 1) / 2];"),t.push("  }"),t.push("}"),Blockly.JavaScript.definitions_.math_median=t.join("\n")),t=Blockly.JavaScript.valueToCode(this,"LIST",Blockly.JavaScript.ORDER_NONE)||"[]",t=Blockly.JavaScript.math_on_list.math_median+"("+t+")";break;case"MODE":Blockly.JavaScript.definitions_.math_modes||(a=Blockly.JavaScript.variableDB_.getDistinctName("math_modes",Blockly.Generator.NAME_TYPE),Blockly.JavaScript.math_on_list.math_modes=a,t=[],t.push("function "+a+"(values) {"),t.push("  var modes = [];"),t.push("  var counts = [];"),t.push("  var maxCount = 0;"),t.push("  for (var i = 0; i < values.length; i++) {"),t.push("    var value = values[i];"),t.push("    var found = false;"),t.push("    var thisCount;"),t.push("    for (var j = 0; j < counts.length; j++) {"),t.push("      if (counts[j][0] === value) {"),t.push("        thisCount = ++counts[j][1];"),t.push("        found = true;"),t.push("        break;"),t.push("      }"),t.push("    }"),t.push("    if (!found) {"),t.push("      counts.push([value, 1]);"),t.push("      thisCount = 1;"),t.push("    }"),t.push("    maxCount = Math.max(thisCount, maxCount);"),t.push("  }"),t.push("  for (var j = 0; j < counts.length; j++) {"),t.push("    if (counts[j][1] == maxCount) {"),t.push("        modes.push(counts[j][0]);"),t.push("    }"),t.push("  }"),t.push("  return modes;"),t.push("}"),Blockly.JavaScript.definitions_.math_modes=t.join("\n")),t=Blockly.JavaScript.valueToCode(this,"LIST",Blockly.JavaScript.ORDER_NONE)||"[]",t=Blockly.JavaScript.math_on_list.math_modes+"("+t+")";break;case"STD_DEV":Blockly.JavaScript.definitions_.math_standard_deviation||(a=Blockly.JavaScript.variableDB_.getDistinctName("math_standard_deviation",Blockly.Generator.NAME_TYPE),Blockly.JavaScript.math_on_list.math_standard_deviation=a,t=[],t.push("function "+a+"(numbers) {"),t.push("  var n = numbers.length;"),t.push("  if (!n) return null;"),t.push("  var mean = numbers.reduce(function(x, y) {return x + y;}) / n;"),t.push("  var variance = 0;"),t.push("  for (var j = 0; j < n; j++) {"),t.push("    variance += Math.pow(numbers[j] - mean, 2);"),t.push("  }"),t.push("  variance = variance / n;"),t.push("  return Math.sqrt(variance);"),t.push("}"),Blockly.JavaScript.definitions_.math_standard_deviation=t.join("\n")),t=Blockly.JavaScript.valueToCode(this,"LIST",Blockly.JavaScript.ORDER_NONE)||"[]",t=Blockly.JavaScript.math_on_list.math_standard_deviation+"("+t+")";break;case"RANDOM":Blockly.JavaScript.definitions_.math_random_item||(a=Blockly.JavaScript.variableDB_.getDistinctName("math_random_item",Blockly.Generator.NAME_TYPE),Blockly.JavaScript.math_on_list.math_random_item=a,t=[],t.push("function "+a+"(list) {"),t.push("  var x = Math.floor(Math.random() * list.length);"),t.push("  return list[x];"),t.push("}"),Blockly.JavaScript.definitions_.math_random_item=t.join("\n")),t=Blockly.JavaScript.valueToCode(this,"LIST",Blockly.JavaScript.ORDER_NONE)||"[]",t=Blockly.JavaScript.math_on_list.math_random_item+"("+t+")";break;default:throw"Unknown operator: "+t}return[t,Blockly.JavaScript.ORDER_FUNCTION_CALL]},Blockly.JavaScript.math_modulo=function(){var t=Blockly.JavaScript.valueToCode(this,"DIVIDEND",Blockly.JavaScript.ORDER_MODULUS)||"0",a=Blockly.JavaScript.valueToCode(this,"DIVISOR",Blockly.JavaScript.ORDER_MODULUS)||"0";return[t+" % "+a,Blockly.JavaScript.ORDER_MODULUS]},Blockly.JavaScript.math_constrain=function(){var t=Blockly.JavaScript.valueToCode(this,"VALUE",Blockly.JavaScript.ORDER_COMMA)||"0",a=Blockly.JavaScript.valueToCode(this,"LOW",Blockly.JavaScript.ORDER_COMMA)||"0",e=Blockly.JavaScript.valueToCode(this,"HIGH",Blockly.JavaScript.ORDER_COMMA)||"Infinity";return["Math.min(Math.max("+t+", "+a+"), "+e+")",Blockly.JavaScript.ORDER_FUNCTION_CALL]},Blockly.JavaScript.math_random_int=function(){var t=Blockly.JavaScript.valueToCode(this,"FROM",Blockly.JavaScript.ORDER_COMMA)||"0",a=Blockly.JavaScript.valueToCode(this,"TO",Blockly.JavaScript.ORDER_COMMA)||"0";if(!Blockly.JavaScript.definitions_.math_random_int){var e=Blockly.JavaScript.variableDB_.getDistinctName("math_random_int",Blockly.Generator.NAME_TYPE);Blockly.JavaScript.math_random_int.random_function=e;var l=[];l.push("function "+e+"(a, b) {"),l.push("  if (a > b) {"),l.push("    // Swap a and b to ensure a is smaller."),l.push("    var c = a;"),l.push("    a = b;"),l.push("    b = c;"),l.push("  }"),l.push("  return Math.floor(Math.random() * (b - a + 1) + a);"),l.push("}"),Blockly.JavaScript.definitions_.math_random_int=l.join("\n")}return[Blockly.JavaScript.math_random_int.random_function+"("+t+", "+a+")",Blockly.JavaScript.ORDER_FUNCTION_CALL]},Blockly.JavaScript.math_random_float=function(){return["Math.random()",Blockly.JavaScript.ORDER_FUNCTION_CALL]},Blockly.JavaScript.lists={},Blockly.JavaScript.lists_create_empty=function(){return["[]",Blockly.JavaScript.ORDER_ATOMIC]},Blockly.JavaScript.lists_create_with=function(){for(var t=Array(this.itemCount_),a=0;a<this.itemCount_;a++)t[a]=Blockly.JavaScript.valueToCode(this,"ADD"+a,Blockly.JavaScript.ORDER_COMMA)||"null";return t="["+t.join(", ")+"]",[t,Blockly.JavaScript.ORDER_ATOMIC]},Blockly.JavaScript.lists_repeat=function(){if(!Blockly.JavaScript.definitions_.lists_repeat){var t=Blockly.JavaScript.variableDB_.getDistinctName("lists_repeat",Blockly.Generator.NAME_TYPE);Blockly.JavaScript.lists_repeat.repeat=t;var a=[];a.push("function "+t+"(value, n) {"),a.push("  var array = [];"),a.push("  for (var i = 0; i < n; i++) {"),a.push("    array[i] = value;"),a.push("  }"),a.push("  return array;"),a.push("}"),Blockly.JavaScript.definitions_.lists_repeat=a.join("\n")}return t=Blockly.JavaScript.valueToCode(this,"ITEM",Blockly.JavaScript.ORDER_COMMA)||"null",a=Blockly.JavaScript.valueToCode(this,"NUM",Blockly.JavaScript.ORDER_COMMA)||"0",[Blockly.JavaScript.lists_repeat.repeat+"("+t+", "+a+")",Blockly.JavaScript.ORDER_FUNCTION_CALL]},Blockly.JavaScript.lists_length=function(){return[(Blockly.JavaScript.valueToCode(this,"VALUE",Blockly.JavaScript.ORDER_FUNCTION_CALL)||"''")+".length",Blockly.JavaScript.ORDER_MEMBER]},Blockly.JavaScript.lists_isEmpty=function(){return["!"+(Blockly.JavaScript.valueToCode(this,"VALUE",Blockly.JavaScript.ORDER_MEMBER)||"[]")+".length",Blockly.JavaScript.ORDER_LOGICAL_NOT]},Blockly.JavaScript.lists_indexOf=function(){var t="FIRST"==this.getTitleValue("END")?"indexOf":"lastIndexOf",a=Blockly.JavaScript.valueToCode(this,"FIND",Blockly.JavaScript.ORDER_NONE)||"''";return[(Blockly.JavaScript.valueToCode(this,"VALUE",Blockly.JavaScript.ORDER_MEMBER)||"[]")+"."+t+"("+a+") + 1",Blockly.JavaScript.ORDER_MEMBER]},Blockly.JavaScript.lists_getIndex=function(){var t=this.getTitleValue("MODE")||"GET",a=this.getTitleValue("WHERE")||"FROM_START",e=Blockly.JavaScript.valueToCode(this,"AT",Blockly.JavaScript.ORDER_UNARY_NEGATION)||"1",l=Blockly.JavaScript.valueToCode(this,"VALUE",Blockly.JavaScript.ORDER_MEMBER)||"[]";if("FIRST"==a){if("GET"==t)return[l+"[0]",Blockly.JavaScript.ORDER_MEMBER];if("GET_REMOVE"==t)return[l+".shift()",Blockly.JavaScript.ORDER_MEMBER];if("REMOVE"==t)return l+".shift();\n"}else if("LAST"==a){if("GET"==t)return[l+".slice(-1)[0]",Blockly.JavaScript.ORDER_MEMBER];if("GET_REMOVE"==t)return[l+".pop()",Blockly.JavaScript.ORDER_MEMBER];if("REMOVE"==t)return l+".pop();\n"}else if("FROM_START"==a){if(e=Blockly.isNumber(e)?parseFloat(e)-1:e+" - 1","GET"==t)return[l+"["+e+"]",Blockly.JavaScript.ORDER_MEMBER];if("GET_REMOVE"==t)return[l+".splice("+e+", 1)[0]",Blockly.JavaScript.ORDER_FUNCTION_CALL];if("REMOVE"==t)return l+".splice("+e+", 1);\n"}else if("FROM_END"==a){if("GET"==t)return[l+".slice(-"+e+")[0]",Blockly.JavaScript.ORDER_FUNCTION_CALL];if("GET_REMOVE"==t||"REMOVE"==t){if(!Blockly.JavaScript.definitions_.lists_remove_from_end){a=Blockly.JavaScript.variableDB_.getDistinctName("lists_remove_from_end",Blockly.Generator.NAME_TYPE),Blockly.JavaScript.lists_getIndex.lists_remove_from_end=a;var i=[];i.push("function "+a+"(list, x) {"),i.push("  x = list.length - x;"),i.push("  return list.splice(x, 1)[0];"),i.push("}"),Blockly.JavaScript.definitions_.lists_remove_from_end=i.join("\n")}if(e=Blockly.JavaScript.lists_getIndex.lists_remove_from_end+"("+l+", "+e+")","GET_REMOVE"==t)return[e,Blockly.JavaScript.ORDER_FUNCTION_CALL];if("REMOVE"==t)return e+";\n"}}else if("RANDOM"==a){if(Blockly.JavaScript.definitions_.lists_get_random_item||(a=Blockly.JavaScript.variableDB_.getDistinctName("lists_get_random_item",Blockly.Generator.NAME_TYPE),Blockly.JavaScript.lists_getIndex.random=a,i=[],i.push("function "+a+"(list, remove) {"),i.push("  var x = Math.floor(Math.random() * list.length);"),i.push("  if (remove) {"),i.push("    return list.splice(x, 1)[0];"),i.push("  } else {"),i.push("    return list[x];"),i.push("  }"),i.push("}"),Blockly.JavaScript.definitions_.lists_get_random_item=i.join("\n")),e=Blockly.JavaScript.lists_getIndex.random+"("+l+", "+("GET"!=t)+")","GET"==t||"GET_REMOVE"==t)return[e,Blockly.JavaScript.ORDER_FUNCTION_CALL];if("REMOVE"==t)return e+";\n"}throw"Unhandled combination (lists_getIndex)."},Blockly.JavaScript.lists_setIndex=function(){function t(){if(a.match(/^\w+$/))return"";var t=Blockly.JavaScript.variableDB_.getDistinctName("tmp_list",Blockly.Variables.NAME_TYPE),e="var "+t+" = "+a+";\n";return a=t,e}var a=Blockly.JavaScript.valueToCode(this,"LIST",Blockly.JavaScript.ORDER_MEMBER)||"[]",e=this.getTitleValue("MODE")||"GET",l=this.getTitleValue("WHERE")||"FROM_START",i=Blockly.JavaScript.valueToCode(this,"AT",Blockly.JavaScript.ORDER_NONE)||"1",r=Blockly.JavaScript.valueToCode(this,"TO",Blockly.JavaScript.ORDER_ASSIGNMENT)||"null";if("FIRST"==l){if("SET"==e)return a+"[0] = "+r+";\n";if("INSERT"==e)return a+".unshift("+r+");\n"}else if("LAST"==l){if("SET"==e)return l=t(),l+(a+"["+a+".length - 1] = "+r+";\n");if("INSERT"==e)return a+".push("+r+");\n"}else if("FROM_START"==l){if(i=Blockly.isNumber(i)?parseFloat(i)-1:i+" - 1","SET"==e)return a+"["+i+"] = "+r+";\n";if("INSERT"==e)return a+".splice("+i+", 0, "+r+");\n"}else if("FROM_END"==l){if(l=t(),"SET"==e)return l+=a+"["+a+".length - "+i+"] = "+r+";\n";if("INSERT"==e)return l+=a+".splice("+a+".length - "+i+", 0, "+r+");\n"}else if("RANDOM"==l){if(l=t(),i=Blockly.JavaScript.variableDB_.getDistinctName("tmp_x",Blockly.Variables.NAME_TYPE),l+="var "+i+" = Math.floor(Math.random() * "+a+".length);\n","SET"==e)return l+=a+"["+i+"] = "+r+";\n";if("INSERT"==e)return l+=a+".splice("+i+", 0, "+r+");\n"}throw"Unhandled combination (lists_setIndex)."},Blockly.JavaScript.lists_getSublist=function(){var t=Blockly.JavaScript.valueToCode(this,"LIST",Blockly.JavaScript.ORDER_MEMBER)||"[]",a=this.getTitleValue("WHERE1"),e=this.getTitleValue("WHERE2"),l=Blockly.JavaScript.valueToCode(this,"AT1",Blockly.JavaScript.ORDER_NONE)||"1",i=Blockly.JavaScript.valueToCode(this,"AT2",Blockly.JavaScript.ORDER_NONE)||"1";if("FIRST"==a&&"LAST"==e)t+=".concat()";else{if(!Blockly.JavaScript.definitions_.lists_get_sublist){var r=Blockly.JavaScript.variableDB_.getDistinctName("lists_get_sublist",Blockly.Generator.NAME_TYPE);Blockly.JavaScript.lists_getSublist.func=r;var o=[];o.push("function "+r+"(list, where1, at1, where2, at2) {"),o.push("  function getAt(where, at) {"),o.push("    if (where == 'FROM_START') {"),o.push("      at--;"),o.push("    } else if (where == 'FROM_END') {"),o.push("      at = list.length - at;"),o.push("    } else if (where == 'FIRST') {"),o.push("      at = 0;"),o.push("    } else if (where == 'LAST') {"),o.push("      at = list.length - 1;"),o.push("    } else {"),o.push("      throw 'Unhandled option (lists_getSublist).';"),o.push("    }"),o.push("    return at;"),o.push("  }"),o.push("  at1 = getAt(where1, at1);"),o.push("  at2 = getAt(where2, at2) + 1;"),o.push("  return list.slice(at1, at2);"),o.push("}"),Blockly.JavaScript.definitions_.lists_get_sublist=o.join("\n")}t=Blockly.JavaScript.lists_getSublist.func+"("+t+", '"+a+"', "+l+", '"+e+"', "+i+")"}return[t,Blockly.JavaScript.ORDER_FUNCTION_CALL]},Blockly.JavaScript.variables={},Blockly.JavaScript.variables_get=function(){return[Blockly.JavaScript.variableDB_.getName(this.getTitleValue("VAR"),Blockly.Variables.NAME_TYPE),Blockly.JavaScript.ORDER_ATOMIC]},Blockly.JavaScript.variables_set=function(){var t=Blockly.JavaScript.valueToCode(this,"VALUE",Blockly.JavaScript.ORDER_ASSIGNMENT)||"0";return Blockly.JavaScript.variableDB_.getName(this.getTitleValue("VAR"),Blockly.Variables.NAME_TYPE)+" = "+t+";\n"};