
<link rel="stylesheet" type="text/css" href="/static/style.css">
  <script type="text/javascript" src="/static/_soy/soyutils.js"></script>
  <script type="text/javascript" src="/static/common.js"></script>
  <script type="text/javascript" src="/static/code.js"></script>
  <script type="text/javascript" src="/static/storage.js"></script>

<script type="text/javascript">
    var hasInit = false; 

 
  function doBlocklyInitialize(){
        if(hasInit){return;}
        hasInit = true;
    
        if(codepage) console.log('yolo')
        $('#blocklyDiv').html(codepage.start({},null,
            {langSrc: BlocklyApps.LANGUAGES[BlocklyApps.LANG][2]}));


        <% if(@code.codetext) %>
            var code =  <%= ("'" + @code.codetext + "'").html_safe %> ;
            var xml_text = Blockly.Xml.textToDom(code);
            //XSS IS A FACTOR NOW AAAAA
            Blockly.Xml.domToWorkspace(Blockly.mainWorkspace, xml_text);
        <% end %>
    }
    $(document).ready(doBlocklyInitialize);
</script>

